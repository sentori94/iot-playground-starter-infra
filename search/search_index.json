{"config":{"lang":["fr"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"IoT Playground Infrastructure","text":"<p>Projet</p> <p>Infrastructure as Code pour une plateforme IoT de simulation de capteurs avec deux architectures d\u00e9ployables : ECS (Classic) et Serverless (Lambda).</p>"},{"location":"#objectif","title":"\ud83c\udfaf Objectif","text":"<p>Comparer deux architectures AWS pour une application IoT :</p> <ul> <li>ECS + RDS PostgreSQL (architecture traditionnelle)</li> <li>Lambda + DynamoDB (architecture serverless)</li> </ul>"},{"location":"#architecture-globale","title":"\ud83c\udfd7\ufe0f Architecture Globale","text":"<pre><code>graph TB\n    subgraph \"Frontend Angular\"\n        A[Application Web]\n    end\n\n    subgraph \"Architecture ECS\"\n        B[Spring Boot&lt;br/&gt;ECS Fargate]\n        C[RDS PostgreSQL]\n        D[Prometheus]\n        E[Grafana ECS]\n    end\n\n    subgraph \"Architecture Serverless\"\n        F[Lambda Run API]\n        G[Lambda Sensor API]\n        H[DynamoDB]\n        I[CloudWatch Logs]\n        J[Grafana ECS]\n    end\n\n    A --&gt;|REST API| B\n    A --&gt;|REST API| F\n    A --&gt;|REST API| G\n\n    B --&gt; C\n    B --&gt; D\n    D --&gt; E\n\n    F --&gt; H\n    G --&gt; H\n    F --&gt; I\n    G --&gt; I\n    I --&gt; J\n\n    style A fill:#e1f5ff\n    style B fill:#fff3e0\n    style F fill:#e8f5e9\n    style G fill:#e8f5e9</code></pre>"},{"location":"#comparaison-rapide","title":"\ud83d\udcca Comparaison Rapide","text":"Crit\u00e8re ECS Classic Serverless Co\u00fbt (idle) ~$80/mois ~$0/mois Co\u00fbt (actif) ~$80/mois Variable Scalabilit\u00e9 Manuelle Automatique Cold Start Non Oui (~1s) Base de donn\u00e9es PostgreSQL DynamoDB Monitoring Prometheus CloudWatch"},{"location":"#demarrage-rapide","title":"\ud83d\ude80 D\u00e9marrage Rapide","text":"ServerlessECS <pre><code># 1. D\u00e9ployer les lambdas\nGitHub Actions \u2192 Deploy Serverless (Unified)\nComponent: lambdas\nAction: apply\n\n# 2. D\u00e9ployer Grafana (optionnel)\nComponent: grafana\nAction: apply\n</code></pre> <pre><code># D\u00e9ployer l'infrastructure compl\u00e8te\ncd infra/envs/dev\nterraform init\nterraform apply\n</code></pre>"},{"location":"#urls","title":"\ud83c\udf10 URLs","text":"<ul> <li>API Lambda : <code>https://api-lambda-iot.sentori-studio.com</code></li> <li>Grafana Serverless : <code>https://grafana-lambda-iot.sentori-studio.com</code></li> <li>Frontend : \u00c0 d\u00e9finir</li> </ul>"},{"location":"#structure-du-projet","title":"\ud83d\udcc1 Structure du Projet","text":"<pre><code>iot-playground-starter-infra/\n\u251c\u2500\u2500 infra/\n\u2502   \u251c\u2500\u2500 envs/\n\u2502   \u2502   \u251c\u2500\u2500 dev/              # Infrastructure ECS\n\u2502   \u2502   \u251c\u2500\u2500 serverless-dev/   # Infrastructure Serverless\n\u2502   \u2502   \u2514\u2500\u2500 cdn-dev/          # CDN pour le frontend\n\u2502   \u251c\u2500\u2500 modules/              # Modules Terraform r\u00e9utilisables\n\u2502   \u2514\u2500\u2500 docker/               # Images Docker (Grafana, Prometheus)\n\u251c\u2500\u2500 scripts/                  # Scripts utilitaires\n\u2514\u2500\u2500 .github/workflows/        # CI/CD GitHub Actions\n</code></pre>"},{"location":"#liens-utiles","title":"\ud83d\udd17 Liens Utiles","text":"<ul> <li>Architecture ECS</li> <li>Architecture Serverless</li> <li>Guide de d\u00e9ploiement</li> <li>API Reference</li> </ul>"},{"location":"api/run-controller/","title":"API Run Controller","text":"<p>Gestion du cycle de vie des simulations (runs).</p>"},{"location":"api/run-controller/#base-url","title":"\ud83c\udfaf Base URL","text":"<ul> <li>Serverless : <code>https://api-lambda-iot.sentori-studio.com</code></li> <li>ECS : <code>https://api-ecs-iot.sentori-studio.com</code> (futur)</li> </ul>"},{"location":"api/run-controller/#endpoints","title":"\ud83d\udccb Endpoints","text":""},{"location":"api/run-controller/#get-apirunscan-start","title":"GET <code>/api/runs/can-start</code>","text":"<p>V\u00e9rifie si on peut d\u00e9marrer une nouvelle simulation.</p> <p>Headers <pre><code>(aucun header requis)\n</code></pre></p> <p>Response 200 <pre><code>{\n  \"canStart\": true,\n  \"currentRunning\": 2,\n  \"maxAllowed\": 5,\n  \"available\": 3\n}\n</code></pre></p> <p>Diagramme <pre><code>sequenceDiagram\n    participant C as Client\n    participant API as Lambda Run API\n    participant DB as DynamoDB\n\n    C-&gt;&gt;API: GET /api/runs/can-start\n    API-&gt;&gt;DB: Scan(status=RUNNING)\n    DB--&gt;&gt;API: Count = 2\n    API-&gt;&gt;API: 2 &lt; 5 ? Yes\n    API--&gt;&gt;C: {canStart: true, currentRunning: 2, ...}</code></pre></p>"},{"location":"api/run-controller/#post-apirunsstart","title":"POST <code>/api/runs/start</code>","text":"<p>D\u00e9marre une nouvelle simulation.</p> <p>Headers <pre><code>Content-Type: application/json\nX-User: username\n</code></pre></p> <p>Body <pre><code>{\n  \"duration\": 60,\n  \"interval\": 5\n}\n</code></pre></p> <p>Response 201 <pre><code>{\n  \"id\": \"550e8400-e29b-41d4-a716-446655440000\",\n  \"username\": \"test-user\",\n  \"status\": \"RUNNING\",\n  \"startedAt\": \"2025-01-15T10:30:00Z\",\n  \"duration\": 60,\n  \"interval\": 5,\n  \"params\": {\n    \"duration\": 60,\n    \"interval\": 5\n  },\n  \"grafanaUrl\": \"https://grafana-lambda-iot.sentori-studio.com/d/...\"\n}\n</code></pre></p> <p>Response 400 (limite atteinte) <pre><code>{\n  \"error\": \"Maximum concurrent runs reached\",\n  \"currentRunning\": 5,\n  \"maxAllowed\": 5\n}\n</code></pre></p> <p>Diagramme <pre><code>sequenceDiagram\n    participant C as Client\n    participant API as Lambda Run API\n    participant DB as DynamoDB\n\n    C-&gt;&gt;API: POST /api/runs/start\n    API-&gt;&gt;API: Check can-start\n\n    alt Limit reached\n        API--&gt;&gt;C: 400 Bad Request\n    else OK\n        API-&gt;&gt;API: Generate UUID\n        API-&gt;&gt;DB: PutItem(id, status:RUNNING, ...)\n        API--&gt;&gt;C: 201 Created {id, grafanaUrl, ...}\n    end</code></pre></p>"},{"location":"api/run-controller/#get-apirunsrunning","title":"GET <code>/api/runs/running</code>","text":"<p>Liste tous les runs en cours (tous utilisateurs).</p> <p>Response 200 <pre><code>[\n  {\n    \"id\": \"550e8400-e29b-41d4-a716-446655440000\",\n    \"username\": \"user1\",\n    \"status\": \"RUNNING\",\n    \"startedAt\": \"2025-01-15T10:30:00Z\",\n    \"duration\": 60,\n    \"interval\": 5\n  },\n  {\n    \"id\": \"660e8400-e29b-41d4-a716-446655440001\",\n    \"username\": \"user2\",\n    \"status\": \"RUNNING\",\n    \"startedAt\": \"2025-01-15T10:32:00Z\",\n    \"duration\": 120,\n    \"interval\": 10\n  }\n]\n</code></pre></p>"},{"location":"api/run-controller/#post-apirunsidfinish","title":"POST <code>/api/runs/{id}/finish</code>","text":"<p>Termine un run en cours.</p> <p>Path Parameters - <code>id</code> : UUID du run</p> <p>Headers <pre><code>Content-Type: application/json\n</code></pre></p> <p>Body (optionnel) <pre><code>{\n  \"errorMessage\": \"Simulation interrupted by user\"\n}\n</code></pre></p> <p>Response 200 <pre><code>{\n  \"id\": \"550e8400-e29b-41d4-a716-446655440000\",\n  \"username\": \"test-user\",\n  \"status\": \"COMPLETED\",\n  \"startedAt\": \"2025-01-15T10:30:00Z\",\n  \"finishedAt\": \"2025-01-15T10:31:00Z\",\n  \"duration\": 60,\n  \"interval\": 5\n}\n</code></pre></p> <p>Response 404 <pre><code>{\n  \"error\": \"Run not found\"\n}\n</code></pre></p> <p>Response 400 <pre><code>{\n  \"error\": \"Run is not running\"\n}\n</code></pre></p>"},{"location":"api/run-controller/#post-apirunsinterrupt-all","title":"POST <code>/api/runs/interrupt-all</code>","text":"<p>Interrompt toutes les simulations en cours (tous utilisateurs).</p> <p>Response 200 <pre><code>{\n  \"interrupted\": 3,\n  \"message\": \"3 simulation(s) interrupted\"\n}\n</code></pre></p> <p>Diagramme <pre><code>sequenceDiagram\n    participant C as Client\n    participant API as Lambda Run API\n    participant DB as DynamoDB\n\n    C-&gt;&gt;API: POST /api/runs/interrupt-all\n    API-&gt;&gt;DB: Scan(status=RUNNING)\n    DB--&gt;&gt;API: [run1, run2, run3]\n\n    loop For each run\n        API-&gt;&gt;DB: UpdateItem(status=INTERRUPTED)\n    end\n\n    API--&gt;&gt;C: {interrupted: 3, message: \"...\"}</code></pre></p>"},{"location":"api/run-controller/#get-apirunsid","title":"GET <code>/api/runs/{id}</code>","text":"<p>D\u00e9tails d'un run sp\u00e9cifique.</p> <p>Path Parameters - <code>id</code> : UUID du run</p> <p>Response 200 <pre><code>{\n  \"id\": \"550e8400-e29b-41d4-a716-446655440000\",\n  \"username\": \"test-user\",\n  \"status\": \"COMPLETED\",\n  \"startedAt\": \"2025-01-15T10:30:00Z\",\n  \"finishedAt\": \"2025-01-15T10:31:00Z\",\n  \"duration\": 60,\n  \"interval\": 5,\n  \"params\": {\n    \"duration\": 60,\n    \"interval\": 5\n  },\n  \"grafanaUrl\": \"https://grafana-lambda-iot.sentori-studio.com/d/...\"\n}\n</code></pre></p> <p>Response 404 <pre><code>{\n  \"error\": \"Run not found\"\n}\n</code></pre></p>"},{"location":"api/run-controller/#get-apiruns","title":"GET <code>/api/runs</code>","text":"<p>Liste pagin\u00e9e de tous les runs.</p> <p>Query Parameters - <code>limit</code> (optional) : Nombre d'items par page (d\u00e9faut: 20) - <code>lastKey</code> (optional) : Cl\u00e9 de pagination (base64)</p> <p>Response 200 <pre><code>{\n  \"items\": [\n    {\n      \"id\": \"550e8400-e29b-41d4-a716-446655440000\",\n      \"username\": \"test-user\",\n      \"status\": \"COMPLETED\",\n      \"startedAt\": \"2025-01-15T10:30:00Z\",\n      \"finishedAt\": \"2025-01-15T10:31:00Z\"\n    }\n  ],\n  \"count\": 20,\n  \"nextKey\": \"eyJpZCI6ICIuLi4ifQ==\"\n}\n</code></pre></p>"},{"location":"api/run-controller/#get-apirunsall","title":"GET <code>/api/runs/all</code>","text":"<p>Tous les runs sans pagination.</p> <p>Response 200 <pre><code>[\n  {\n    \"id\": \"550e8400-e29b-41d4-a716-446655440000\",\n    \"username\": \"test-user\",\n    \"status\": \"COMPLETED\",\n    \"startedAt\": \"2025-01-15T10:30:00Z\"\n  },\n  ...\n]\n</code></pre></p>"},{"location":"api/run-controller/#etats-du-run","title":"\ud83d\udcca \u00c9tats du Run","text":"<pre><code>stateDiagram-v2\n    [*] --&gt; RUNNING: POST /start\n\n    RUNNING --&gt; COMPLETED: POST /finish (success)\n    RUNNING --&gt; FAILED: POST /finish (error)\n    RUNNING --&gt; INTERRUPTED: POST /interrupt-all\n\n    COMPLETED --&gt; [*]\n    FAILED --&gt; [*]\n    INTERRUPTED --&gt; [*]</code></pre>"},{"location":"api/run-controller/#authentification","title":"\ud83d\udd10 Authentification","text":"<p>Actuellement : Header <code>X-User</code></p> <pre><code>curl -H \"X-User: mon-username\" \\\n  https://api-lambda-iot.sentori-studio.com/api/runs/running\n</code></pre>"},{"location":"api/run-controller/#codes-derreur","title":"\ud83d\udea8 Codes d'Erreur","text":"Code Description 200 Success 201 Created 400 Bad Request (limite, validation) 404 Run not found 405 Method not allowed 500 Internal server error"},{"location":"api/run-controller/#liens","title":"\ud83d\udd17 Liens","text":"<ul> <li>Sensor Controller API</li> <li>Guide Simulations</li> </ul>"},{"location":"architecture/comparison/","title":"Architecture ECS vs Serverless","text":""},{"location":"architecture/comparison/#tableau-comparatif","title":"\ud83d\udcca Tableau Comparatif","text":"Aspect ECS Classic Serverless Lambda Runtime Spring Boot (Java) Python 3.11 Base de donn\u00e9es PostgreSQL (RDS) DynamoDB Compute ECS Fargate (Always-on) Lambda (On-demand) Scaling Auto-scaling ECS Auto-scaling Lambda Cold Start \u274c Aucun \u26a0\ufe0f ~1-2s (first request) Co\u00fbt idle ~$80/mois ~$1/mois (sans Grafana) Co\u00fbt actif ~$80/mois (fixe) Variable selon usage Monitoring Prometheus CloudWatch Logs Grafana Datasource Prometheus Datasource CloudWatch HTTPS \u2705 ALB + ACM \u2705 API Gateway + ACM Authentification Header X-User Header X-User Limite concurrent Configurable ECS 5 runs globaux"},{"location":"architecture/comparison/#cas-dusage-recommandes","title":"\ud83c\udfaf Cas d'Usage Recommand\u00e9s","text":""},{"location":"architecture/comparison/#ecs-classic","title":"ECS Classic","text":"<pre><code>graph TB\n    A[Besoin d'ECS ?] --&gt; B{Trafic continu ?}\n    B --&gt;|Oui| C[\u2705 ECS recommand\u00e9]\n    B --&gt;|Non| D{Budget fixe ?}\n    D --&gt;|Oui| E[\u2705 ECS si &lt;100 req/min]\n    D --&gt;|Non| F[\u274c Serverless mieux]\n\n    G[Performance critique ?] --&gt; H{Latence &lt;50ms ?}\n    H --&gt;|Oui| I[\u2705 ECS recommand\u00e9]\n    H --&gt;|Non| J[\u2705 Les deux OK]\n\n    style C fill:#e8f5e9\n    style I fill:#e8f5e9</code></pre> <p>Avantages ECS : - \u2705 Pas de cold start - \u2705 Connexions persistantes (BDD, cache) - \u2705 Latence pr\u00e9visible - \u2705 Debugging plus simple (logs structur\u00e9s) - \u2705 \u00c9cosyst\u00e8me Java mature</p> <p>Inconv\u00e9nients ECS : - \u274c Co\u00fbt fixe m\u00eame sans trafic - \u274c Gestion de l'infrastructure - \u274c Scaling moins r\u00e9actif</p>"},{"location":"architecture/comparison/#serverless-lambda","title":"Serverless Lambda","text":"<pre><code>graph TB\n    A[Besoin de Serverless ?] --&gt; B{Trafic sporadique ?}\n    B --&gt;|Oui| C[\u2705 Serverless recommand\u00e9]\n    B --&gt;|Non| D{Budget limit\u00e9 ?}\n    D --&gt;|Oui| E[\u2705 Serverless recommand\u00e9]\n    D --&gt;|Non| F{Pic de charge ?}\n    F --&gt;|Oui| G[\u2705 Serverless excellent]\n    F --&gt;|Non| H[\u2705 ECS peut suffire]\n\n    style C fill:#e8f5e9\n    style E fill:#e8f5e9\n    style G fill:#e8f5e9</code></pre> <p>Avantages Serverless : - \u2705 Pay-per-use (co\u00fbt = usage r\u00e9el) - \u2705 Scaling automatique infini - \u2705 Pas de gestion serveur - \u2705 DynamoDB tr\u00e8s performant</p> <p>Inconv\u00e9nients Serverless : - \u274c Cold start (~1-2s) - \u274c Timeout max 15 minutes - \u274c Debugging plus complexe - \u274c Vendor lock-in AWS</p>"},{"location":"architecture/comparison/#analyse-couts-detaillee","title":"\ud83d\udcb0 Analyse Co\u00fbts D\u00e9taill\u00e9e","text":""},{"location":"architecture/comparison/#scenario-1000-reqjour","title":"Sc\u00e9nario : 1000 req/jour","text":"ECSServerless Ressource Co\u00fbt mensuel Fargate (1 task, 0.5 vCPU, 1 GB) ~$30 RDS PostgreSQL (db.t3.micro) ~$15 ALB ~$16 Prometheus ECS ~$15 Grafana ECS ~$15 TOTAL ~$90/mois Ressource Co\u00fbt mensuel Lambda (30k invocations) ~$0.01 DynamoDB (on-demand, 30k writes) ~$0.40 API Gateway (30k requests) ~$0.10 CloudWatch Logs (5 GB) ~$2.50 Grafana ECS (si actif) ~$40 VPC (NAT, IGW pour Grafana) ~$40 TOTAL (avec Grafana) ~$83/mois TOTAL (sans Grafana) ~$3/mois"},{"location":"architecture/comparison/#scenario-100k-reqjour","title":"Sc\u00e9nario : 100k req/jour","text":"ECSServerless Ressource Co\u00fbt mensuel Fargate (2 tasks, 1 vCPU, 2 GB) ~$60 RDS PostgreSQL (db.t3.small) ~$30 ALB ~$20 Prometheus ECS ~$15 Grafana ECS ~$15 TOTAL ~$140/mois Ressource Co\u00fbt mensuel Lambda (3M invocations) ~$1.20 DynamoDB (3M writes) ~$40 API Gateway (3M requests) ~$10 CloudWatch Logs (50 GB) ~$25 Grafana ECS ~$40 VPC ~$40 TOTAL ~$156/mois <pre><code>graph LR\n    A[0 req/jour] --&gt;|ECS| B[$90]\n    A --&gt;|Serverless| C[$3]\n\n    D[1k req/jour] --&gt;|ECS| E[$90]\n    D --&gt;|Serverless| F[$83]\n\n    G[100k req/jour] --&gt;|ECS| H[$140]\n    G --&gt;|Serverless| I[$156]\n\n    J[1M req/jour] --&gt;|ECS| K[$200]\n    J --&gt;|Serverless| L[$800+]\n\n    style C fill:#e8f5e9\n    style F fill:#e8f5e9</code></pre> <p>Conclusion Co\u00fbts</p> <ul> <li>&lt; 10k req/jour \u2192 Serverless beaucoup moins cher</li> <li>10k - 50k req/jour \u2192 \u00c9quivalent</li> <li>&gt; 100k req/jour \u2192 ECS plus \u00e9conomique</li> </ul>"},{"location":"architecture/comparison/#performance","title":"\u26a1 Performance","text":""},{"location":"architecture/comparison/#latence","title":"Latence","text":"<pre><code>graph LR\n    subgraph \"ECS\"\n        A[P50: 50ms]\n        B[P95: 100ms]\n        C[P99: 150ms]\n    end\n\n    subgraph \"Serverless (warm)\"\n        D[P50: 80ms]\n        E[P95: 200ms]\n        F[P99: 500ms]\n    end\n\n    subgraph \"Serverless (cold)\"\n        G[P50: 1500ms]\n        H[P95: 2500ms]\n        I[P99: 3500ms]\n    end\n\n    style A fill:#e8f5e9\n    style D fill:#fff9c4\n    style G fill:#ffebee</code></pre>"},{"location":"architecture/comparison/#throughput","title":"Throughput","text":"Architecture Max Throughput Scaling Time ECS ~1000 req/s (2 tasks) 2-3 minutes Serverless ~10000 req/s (1000 lambdas) &lt; 10 secondes"},{"location":"architecture/comparison/#migration","title":"\ud83d\udd04 Migration","text":""},{"location":"architecture/comparison/#ecs-serverless","title":"ECS \u2192 Serverless","text":"<pre><code>graph TB\n    A[Spring Boot API] --&gt;|1. Analyser| B[Endpoints REST]\n    B --&gt;|2. Convertir| C[Lambda Handlers Python]\n    C --&gt;|3. Adapter| D[DynamoDB Schema]\n\n    E[PostgreSQL] --&gt;|4. Exporter| F[Data JSON]\n    F --&gt;|5. Importer| D\n\n    G[Prometheus] --&gt;|6. Remplacer| H[CloudWatch Metrics]\n\n    I[Grafana] --&gt;|7. Changer datasource| J[CloudWatch Logs]\n\n    style C fill:#e8f5e9\n    style D fill:#e8f5e9</code></pre>"},{"location":"architecture/comparison/#serverless-ecs","title":"Serverless \u2192 ECS","text":"<pre><code>graph TB\n    A[Lambda Python] --&gt;|1. Convertir| B[Spring Boot Controllers]\n    B --&gt;|2. Adapter| C[JPA Entities]\n\n    D[DynamoDB] --&gt;|3. Exporter| E[Data JSON]\n    E --&gt;|4. Importer| F[PostgreSQL]\n\n    G[CloudWatch] --&gt;|5. Migrer| H[Prometheus]\n\n    I[Grafana] --&gt;|6. Changer datasource| J[Prometheus]\n\n    style B fill:#fff3e0\n    style C fill:#fff3e0</code></pre>"},{"location":"architecture/comparison/#recommandation","title":"\ud83c\udf93 Recommandation","text":"<pre><code>graph TD\n    A{Objectif du projet ?} --&gt; B[Apprentissage]\n    A --&gt; C[Production]\n\n    B --&gt; D[\u2705 D\u00e9ployer les DEUX]\n    D --&gt; E[Comparer performances]\n    D --&gt; F[Comparer co\u00fbts]\n    D --&gt; G[Comparer dev experience]\n\n    C --&gt; H{Budget ?}\n    H --&gt;|Limit\u00e9| I[\u2705 Serverless]\n    H --&gt;|Fixe OK| J{Trafic ?}\n\n    J --&gt;|Constant| K[\u2705 ECS]\n    J --&gt;|Sporadique| L[\u2705 Serverless]\n\n    style D fill:#e1f5ff\n    style I fill:#e8f5e9\n    style K fill:#fff3e0\n    style L fill:#e8f5e9</code></pre> <p>Pour ce projet</p> <p>Les deux architectures sont d\u00e9ploy\u00e9es pour permettre la comparaison :</p> <ul> <li>ECS : <code>infra/envs/dev/</code></li> <li>Serverless : <code>infra/envs/serverless-dev/</code></li> </ul> <p>\u2192 Choix dans le frontend : \"Mode ECS\" vs \"Mode Serverless\"</p>"},{"location":"architecture/overview/","title":"Vue d'ensemble Architecture","text":""},{"location":"architecture/overview/#deux-modes-de-deploiement","title":"\ud83c\udfaf Deux Modes de D\u00e9ploiement","text":"<pre><code>graph LR\n    A[Frontend Angular] --&gt; B{Mode ?}\n    B --&gt;|ECS| C[Spring Boot&lt;br/&gt;ECS Fargate]\n    B --&gt;|Serverless| D[Lambda&lt;br/&gt;API Gateway]\n\n    C --&gt; E[RDS PostgreSQL]\n    D --&gt; F[DynamoDB]\n\n    C --&gt; G[Prometheus]\n    D --&gt; H[CloudWatch]\n\n    G --&gt; I[Grafana ECS]\n    H --&gt; J[Grafana ECS]\n\n    style C fill:#fff3e0\n    style D fill:#e8f5e9</code></pre>"},{"location":"architecture/overview/#infrastructure-complete","title":"\ud83c\udfd7\ufe0f Infrastructure Compl\u00e8te","text":"<pre><code>graph TB\n    subgraph \"DNS &amp; CDN\"\n        DNS[Route53&lt;br/&gt;sentori-studio.com]\n        CERT[ACM Certificates&lt;br/&gt;*.sentori-studio.com]\n    end\n\n    subgraph \"Mode ECS (dev)\"\n        ECS[ECS Cluster]\n        ALB_ECS[Application Load Balancer]\n        RDS[(RDS PostgreSQL)]\n        PROM[Prometheus]\n        GRAF_ECS[Grafana]\n    end\n\n    subgraph \"Mode Serverless (serverless-dev)\"\n        APIGW[API Gateway]\n        LAMBDA_RUN[Lambda Run API]\n        LAMBDA_SENSOR[Lambda Sensor API]\n        DYNAMO[(DynamoDB)]\n        CW[CloudWatch Logs]\n        GRAF_SLSS[Grafana]\n    end\n\n    subgraph \"Infrastructure Partag\u00e9e\"\n        VPC[VPC]\n        S3[S3 Terraform State]\n        LOCK[DynamoDB Lock Table]\n    end\n\n    DNS --&gt; CERT\n    DNS --&gt; ALB_ECS\n    DNS --&gt; APIGW\n    DNS --&gt; GRAF_SLSS\n\n    CERT --&gt; ALB_ECS\n    CERT --&gt; APIGW\n    CERT --&gt; GRAF_SLSS\n\n    ALB_ECS --&gt; ECS\n    ECS --&gt; RDS\n    ECS --&gt; PROM\n    PROM --&gt; GRAF_ECS\n\n    APIGW --&gt; LAMBDA_RUN\n    APIGW --&gt; LAMBDA_SENSOR\n    LAMBDA_RUN --&gt; DYNAMO\n    LAMBDA_SENSOR --&gt; DYNAMO\n    LAMBDA_RUN --&gt; CW\n    LAMBDA_SENSOR --&gt; CW\n    CW --&gt; GRAF_SLSS\n\n    VPC -.-&gt; ECS\n    VPC -.-&gt; RDS\n    VPC -.-&gt; GRAF_ECS\n    VPC -.-&gt; GRAF_SLSS\n\n    style ECS fill:#fff3e0\n    style LAMBDA_RUN fill:#e8f5e9\n    style LAMBDA_SENSOR fill:#e8f5e9</code></pre>"},{"location":"architecture/overview/#flux-de-donnees","title":"\ud83d\udcca Flux de Donn\u00e9es","text":""},{"location":"architecture/overview/#mode-ecs","title":"Mode ECS","text":"<pre><code>sequenceDiagram\n    participant U as Utilisateur\n    participant F as Frontend\n    participant ALB as ALB\n    participant API as Spring Boot\n    participant DB as PostgreSQL\n    participant P as Prometheus\n    participant G as Grafana\n\n    U-&gt;&gt;F: D\u00e9marrer simulation\n    F-&gt;&gt;ALB: POST /api/runs/start\n    ALB-&gt;&gt;API: Forward\n    API-&gt;&gt;DB: INSERT run\n    API-&gt;&gt;DB: INSERT sensor_data\n    API--&gt;&gt;F: Run cr\u00e9\u00e9\n\n    loop Monitoring\n        P-&gt;&gt;API: Scrape /actuator/prometheus\n        U-&gt;&gt;G: Consulter dashboard\n        G-&gt;&gt;P: Query metrics\n        G--&gt;&gt;U: Afficher graphiques\n    end</code></pre>"},{"location":"architecture/overview/#mode-serverless","title":"Mode Serverless","text":"<pre><code>sequenceDiagram\n    participant U as Utilisateur\n    participant F as Frontend\n    participant AG as API Gateway\n    participant LR as Lambda Run\n    participant LS as Lambda Sensor\n    participant DB as DynamoDB\n    participant CW as CloudWatch\n    participant G as Grafana\n\n    U-&gt;&gt;F: D\u00e9marrer simulation\n    F-&gt;&gt;AG: POST /api/runs/start\n    AG-&gt;&gt;LR: Invoke\n    LR-&gt;&gt;DB: PutItem (Run)\n    LR-&gt;&gt;CW: Log metrics\n    LR--&gt;&gt;F: Run cr\u00e9\u00e9\n\n    F-&gt;&gt;AG: POST /api/sensors/data\n    AG-&gt;&gt;LS: Invoke\n    LS-&gt;&gt;DB: PutItem (SensorData)\n    LS-&gt;&gt;CW: Log metrics\n\n    loop Monitoring\n        U-&gt;&gt;G: Consulter dashboard\n        G-&gt;&gt;CW: Query logs\n        G--&gt;&gt;U: Afficher graphiques\n    end</code></pre>"},{"location":"architecture/overview/#securite","title":"\ud83d\udd10 S\u00e9curit\u00e9","text":"<pre><code>graph TB\n    subgraph \"Authentification &amp; Autorisation\"\n        A[Headers HTTP]\n        B[X-User Header]\n        C[API Key Future]\n    end\n\n    subgraph \"R\u00e9seau\"\n        D[VPC]\n        E[Security Groups]\n        F[Private Subnets]\n        G[Public Subnets]\n    end\n\n    subgraph \"Certificats\"\n        H[ACM Wildcard]\n        I[HTTPS Only]\n    end\n\n    A --&gt; B\n    A --&gt; C\n\n    D --&gt; E\n    D --&gt; F\n    D --&gt; G\n\n    F --&gt; RDS[(RDS)]\n    F --&gt; ECS[ECS Tasks]\n    G --&gt; ALB[Load Balancer]\n\n    H --&gt; I\n    I --&gt; ALB\n    I --&gt; AG[API Gateway]\n\n    style D fill:#e3f2fd\n    style H fill:#fff9c4</code></pre>"},{"location":"architecture/overview/#environnements","title":"\ud83c\udf9b\ufe0f Environnements","text":"Environnement Architecture Objectif dev ECS + RDS Architecture classique, toujours actif serverless-dev Lambda + DynamoDB Architecture serverless, pay-per-use cdn-dev CloudFront + S3 H\u00e9bergement frontend (futur)"},{"location":"architecture/overview/#cycle-de-vie","title":"\ud83d\udd04 Cycle de Vie","text":"<pre><code>stateDiagram-v2\n    [*] --&gt; Provisioning: terraform apply\n\n    Provisioning --&gt; Running: D\u00e9ploiement r\u00e9ussi\n    Provisioning --&gt; Failed: Erreur\n\n    Running --&gt; Updating: Changement config\n    Updating --&gt; Running: Mise \u00e0 jour OK\n\n    Running --&gt; Scaling: Charge augmente\n    Scaling --&gt; Running: Auto-scaling\n\n    Running --&gt; Destroying: terraform destroy\n    Destroying --&gt; [*]: Ressources supprim\u00e9es\n\n    Failed --&gt; Provisioning: Correction + Retry</code></pre>"},{"location":"architecture/serverless/","title":"Architecture Serverless","text":""},{"location":"architecture/serverless/#vue-densemble","title":"\ud83c\udfaf Vue d'ensemble","text":"<pre><code>graph TB\n    subgraph \"API Gateway\"\n        AG[API Gateway&lt;br/&gt;api-lambda-iot.sentori-studio.com]\n    end\n\n    subgraph \"Lambda Functions\"\n        LR[Lambda Run API&lt;br/&gt;Python 3.11]\n        LS[Lambda Sensor API&lt;br/&gt;Python 3.11]\n    end\n\n    subgraph \"Stockage\"\n        DR[(DynamoDB Runs)]\n        DS[(DynamoDB SensorData)]\n    end\n\n    subgraph \"Monitoring\"\n        CW[CloudWatch Logs]\n        GRAF[Grafana ECS&lt;br/&gt;grafana-lambda-iot.sentori-studio.com]\n    end\n\n    subgraph \"R\u00e9seau\"\n        VPC[VPC 10.1.0.0/16]\n        PUB[Public Subnets]\n        PRIV[Private Subnets]\n        ALB[ALB Grafana]\n    end\n\n    AG --&gt;|invoke| LR\n    AG --&gt;|invoke| LS\n\n    LR --&gt; DR\n    LS --&gt; DS\n\n    LR -.log.-&gt; CW\n    LS -.log.-&gt; CW\n\n    CW --&gt; GRAF\n\n    GRAF --&gt; ALB\n    ALB --&gt; PUB\n    PRIV --&gt; GRAF\n    VPC --&gt; PUB\n    VPC --&gt; PRIV\n\n    style LR fill:#e8f5e9\n    style LS fill:#e8f5e9\n    style AG fill:#e1f5ff\n    style GRAF fill:#fff3e0</code></pre>"},{"location":"architecture/serverless/#ressources-aws","title":"\ud83d\udccb Ressources AWS","text":""},{"location":"architecture/serverless/#lambda-functions","title":"Lambda Functions","text":"Fonction Runtime M\u00e9moire Timeout Trigger run-api Python 3.11 512 MB 30s API Gateway sensor-api Python 3.11 512 MB 30s API Gateway"},{"location":"architecture/serverless/#dynamodb-tables","title":"DynamoDB Tables","text":"<p>Runs Table <pre><code>Partition Key: id (String, UUID)\nAttributes:\n  - username (String)\n  - status (String: RUNNING, COMPLETED, FAILED, INTERRUPTED)\n  - startedAt (String, ISO 8601)\n  - finishedAt (String, ISO 8601, optional)\n  - duration (Number, seconds)\n  - interval (Number, seconds)\n  - params (Map)\n  - grafanaUrl (String)\n</code></pre></p> <p>SensorData Table <pre><code>Partition Key: id (String, UUID)\nSort Key: timestamp (String, ISO 8601)\nAttributes:\n  - runId (String, UUID)\n  - username (String)\n  - sensorId (String)\n  - temperature (Number)\n  - humidity (Number, optional)\n  - pressure (Number, optional)\n</code></pre></p>"},{"location":"architecture/serverless/#flux-api","title":"\ud83d\udd04 Flux API","text":""},{"location":"architecture/serverless/#demarrer-une-simulation","title":"D\u00e9marrer une Simulation","text":"<pre><code>sequenceDiagram\n    participant F as Frontend\n    participant AG as API Gateway\n    participant LR as Lambda Run\n    participant DR as DynamoDB Runs\n    participant CW as CloudWatch\n\n    F-&gt;&gt;AG: POST /api/runs/start&lt;br/&gt;{duration: 60, interval: 5}\n    AG-&gt;&gt;LR: Invoke\n\n    LR-&gt;&gt;LR: Check can-start&lt;br/&gt;(max 5 concurrent)\n\n    alt Limite atteinte\n        LR--&gt;&gt;F: 400 Bad Request&lt;br/&gt;Max concurrent reached\n    else OK\n        LR-&gt;&gt;LR: Generate UUID\n        LR-&gt;&gt;DR: PutItem&lt;br/&gt;{id, status: RUNNING, ...}\n        LR-&gt;&gt;CW: PutMetricData&lt;br/&gt;run_started=1\n        LR--&gt;&gt;F: 201 Created&lt;br/&gt;{id, grafanaUrl, ...}\n    end</code></pre>"},{"location":"architecture/serverless/#ingerer-des-donnees-capteur","title":"Ing\u00e9rer des Donn\u00e9es Capteur","text":"<pre><code>sequenceDiagram\n    participant F as Frontend\n    participant AG as API Gateway\n    participant LS as Lambda Sensor\n    participant DS as DynamoDB SensorData\n    participant CW as CloudWatch\n\n    loop Toutes les 5 secondes\n        F-&gt;&gt;AG: POST /api/sensors/data&lt;br/&gt;{runId, sensorId, temperature}\n        AG-&gt;&gt;LS: Invoke\n        LS-&gt;&gt;LS: Validate data\n        LS-&gt;&gt;DS: PutItem&lt;br/&gt;{id, timestamp, ...}\n        LS-&gt;&gt;CW: PutMetricData&lt;br/&gt;temperature=XX\n        LS--&gt;&gt;F: 201 Created\n    end</code></pre>"},{"location":"architecture/serverless/#endpoints-api","title":"\ud83c\udf9b\ufe0f Endpoints API","text":""},{"location":"architecture/serverless/#run-controller","title":"Run Controller","text":"M\u00e9thode Endpoint Description GET <code>/api/runs/can-start</code> V\u00e9rifier limite (5 max global) GET <code>/api/runs/running</code> Lister runs actifs (tous users) POST <code>/api/runs/start</code> D\u00e9marrer simulation POST <code>/api/runs/{id}/finish</code> Terminer simulation POST <code>/api/runs/interrupt-all</code> Interrompre toutes simulations GET <code>/api/runs/{id}</code> D\u00e9tails d'un run GET <code>/api/runs</code> Liste pagin\u00e9e GET <code>/api/runs/all</code> Tous les runs"},{"location":"architecture/serverless/#sensor-controller","title":"Sensor Controller","text":"M\u00e9thode Endpoint Description POST <code>/api/sensors/data</code> Ing\u00e9rer donn\u00e9es capteur GET <code>/api/sensors/data</code> R\u00e9cup\u00e9rer donn\u00e9es"},{"location":"architecture/serverless/#monitoring-cloudwatch","title":"\ud83d\udcca Monitoring CloudWatch","text":"<pre><code>graph LR\n    subgraph \"Lambda Metrics\"\n        A[Invocations]\n        B[Duration]\n        C[Errors]\n        D[Throttles]\n    end\n\n    subgraph \"Custom Metrics\"\n        E[run_started]\n        F[run_completed]\n        G[sensor_data_ingested]\n        H[temperature_avg]\n    end\n\n    subgraph \"DynamoDB Metrics\"\n        I[ConsumedReadCapacity]\n        J[ConsumedWriteCapacity]\n    end\n\n    A --&gt; GRAF[Grafana Dashboard]\n    B --&gt; GRAF\n    C --&gt; GRAF\n    E --&gt; GRAF\n    F --&gt; GRAF\n    G --&gt; GRAF\n    H --&gt; GRAF\n    I --&gt; GRAF\n    J --&gt; GRAF\n\n    style GRAF fill:#fff3e0</code></pre>"},{"location":"architecture/serverless/#couts","title":"\ud83d\udcb0 Co\u00fbts","text":"<p>Configuration actuelle (serverless-dev)</p> Ressource Co\u00fbt Idle Co\u00fbt Actif (estimation) Lambda (2 fonctions) $0 $0.0000002 / invocation DynamoDB (2 tables, on-demand) $0 $0.25 / million writes API Gateway $0 $3.50 / million requests CloudWatch Logs ~$0.50/mois Variable Grafana ECS ~$40/mois ~$40/mois VPC (NAT, IGW) ~$40/mois ~$40/mois TOTAL ~$80/mois ~$80/mois + usage <p>\u00c9conomie</p> <p>Pour r\u00e9duire les co\u00fbts, d\u00e9truire Grafana quand non utilis\u00e9 : <pre><code>Component: grafana\nAction: destroy\n</code></pre> \u2192 Co\u00fbt idle : ~$1/mois (CloudWatch Logs uniquement)</p>"},{"location":"architecture/serverless/#securite","title":"\ud83d\udd10 S\u00e9curit\u00e9","text":"<pre><code>graph TB\n    subgraph \"API Gateway\"\n        A[HTTPS Only]\n        B[Custom Domain]\n        C[ACM Certificate]\n    end\n\n    subgraph \"Lambda\"\n        D[IAM Execution Role]\n        E[VPC Endpoints Future]\n        F[Environment Variables]\n    end\n\n    subgraph \"DynamoDB\"\n        G[Encryption at Rest]\n        H[IAM Permissions]\n    end\n\n    A --&gt; B\n    B --&gt; C\n    D --&gt; H\n    F -.contains.-&gt; CREDS[Secrets]\n\n    style A fill:#fff9c4\n    style D fill:#fff9c4\n    style G fill:#fff9c4</code></pre>"},{"location":"architecture/serverless/#deploiement","title":"\ud83d\ude80 D\u00e9ploiement","text":"<pre><code>graph LR\n    A[Git Push] --&gt; B[GitHub Actions]\n    B --&gt; C{Component}\n\n    C --&gt;|lambdas| D[Deploy Lambdas]\n    C --&gt;|grafana| E[Deploy Grafana]\n    C --&gt;|full| F[Deploy All]\n\n    D --&gt; G[Terraform Apply&lt;br/&gt;-target=lambdas]\n    E --&gt; H[Terraform Apply&lt;br/&gt;-target=grafana]\n    F --&gt; I[Terraform Apply&lt;br/&gt;no target]\n\n    G --&gt; J[Lambda + DynamoDB + API Gateway]\n    H --&gt; K[VPC + ECS + Grafana]\n    I --&gt; L[Tout cr\u00e9\u00e9]\n\n    style B fill:#e8f5e9</code></pre>"},{"location":"guide/quickstart/","title":"D\u00e9marrage Rapide","text":""},{"location":"guide/quickstart/#installation","title":"\ud83d\ude80 Installation","text":""},{"location":"guide/quickstart/#prerequis","title":"Pr\u00e9requis","text":"<ul> <li>AWS CLI configur\u00e9</li> <li>Terraform &gt;= 1.6.0</li> <li>Acc\u00e8s GitHub Actions (pour CI/CD)</li> <li>Compte AWS avec permissions IAM suffisantes</li> </ul>"},{"location":"guide/quickstart/#configuration-aws-cli","title":"Configuration AWS CLI","text":"<pre><code>aws configure\n# AWS Access Key ID: VOTRE_ACCESS_KEY\n# AWS Secret Access Key: VOTRE_SECRET_KEY\n# Default region: eu-west-3\n# Default output format: json\n</code></pre>"},{"location":"guide/quickstart/#deploiement-serverless-recommande","title":"\ud83c\udfaf D\u00e9ploiement Serverless (Recommand\u00e9)","text":""},{"location":"guide/quickstart/#etape-1-deployer-les-lambdas","title":"\u00c9tape 1 : D\u00e9ployer les Lambdas","text":"GitHub ActionsLocal (Terraform) <ol> <li>Aller dans Actions \u2192 Deploy Serverless (Unified)</li> <li>Cliquer sur Run workflow</li> <li>Configurer :<ul> <li>Component: <code>lambdas</code></li> <li>Action: <code>apply</code></li> </ul> </li> <li>Attendre ~5 minutes</li> </ol> <pre><code>cd infra/envs/serverless-dev\n\n# Initialiser\nterraform init\n\n# Plan\nterraform plan \\\n  -target=module.acm_lambda_api \\\n  -target=module.dynamodb_tables \\\n  -target=module.lambda_run_api \\\n  -target=module.lambda_sensor_api \\\n  -target=module.api_gateway_lambda_iot\n\n# Apply\nterraform apply \\\n  -target=module.acm_lambda_api \\\n  -target=module.dynamodb_tables \\\n  -target=module.lambda_run_api \\\n  -target=module.lambda_sensor_api \\\n  -target=module.api_gateway_lambda_iot\n</code></pre>"},{"location":"guide/quickstart/#etape-2-recuperer-lurl-api","title":"\u00c9tape 2 : R\u00e9cup\u00e9rer l'URL API","text":"<pre><code>cd infra/envs/serverless-dev\nterraform output api_gateway_url\n# https://api-lambda-iot.sentori-studio.com\n</code></pre>"},{"location":"guide/quickstart/#etape-3-tester-lapi","title":"\u00c9tape 3 : Tester l'API","text":"<pre><code># Can start ?\ncurl https://api-lambda-iot.sentori-studio.com/api/runs/can-start\n\n# D\u00e9marrer une simulation\ncurl -X POST https://api-lambda-iot.sentori-studio.com/api/runs/start \\\n  -H \"Content-Type: application/json\" \\\n  -H \"X-User: test-user\" \\\n  -d '{\"duration\": 60, \"interval\": 5}'\n\n# Lister les runs\ncurl https://api-lambda-iot.sentori-studio.com/api/runs\n</code></pre>"},{"location":"guide/quickstart/#etape-4-deployer-grafana-optionnel","title":"\u00c9tape 4 : D\u00e9ployer Grafana (Optionnel)","text":"GitHub ActionsLocal <ol> <li>Actions \u2192 Deploy Serverless (Unified)</li> <li>Configurer :<ul> <li>Component: <code>grafana</code></li> <li>Action: <code>apply</code></li> </ul> </li> <li>Attendre ~10 minutes (VPC + ECS)</li> </ol> <pre><code>terraform apply \\\n  -target=module.acm_grafana \\\n  -target=module.vpc_serverless \\\n  -target=module.ecs_cluster_serverless \\\n  -target=aws_iam_role.grafana_cloudwatch \\\n  -target=aws_iam_role_policy.grafana_cloudwatch \\\n  -target=module.grafana_serverless\n</code></pre>"},{"location":"guide/quickstart/#etape-5-acceder-a-grafana","title":"\u00c9tape 5 : Acc\u00e9der \u00e0 Grafana","text":"<pre><code># R\u00e9cup\u00e9rer l'URL\nterraform output grafana_url\n# https://grafana-lambda-iot.sentori-studio.com\n</code></pre> <p>Ouvrir dans le navigateur \u2192 Dashboard d\u00e9j\u00e0 configur\u00e9 ! \ud83c\udf89</p>"},{"location":"guide/quickstart/#architecture-deployee","title":"\ud83d\udcca Architecture D\u00e9ploy\u00e9e","text":"<pre><code>graph TB\n    subgraph \"\u2705 D\u00e9ploy\u00e9\"\n        A[API Gateway]\n        B[Lambda Run API]\n        C[Lambda Sensor API]\n        D[DynamoDB Runs]\n        E[DynamoDB SensorData]\n        F[CloudWatch Logs]\n    end\n\n    subgraph \"\u26a0\ufe0f Optionnel\"\n        G[Grafana ECS]\n        H[VPC]\n        I[ALB]\n    end\n\n    A --&gt; B\n    A --&gt; C\n    B --&gt; D\n    C --&gt; E\n    B -.log.-&gt; F\n    C -.log.-&gt; F\n\n    F --&gt; G\n    G --&gt; I\n    I --&gt; H\n\n    style A fill:#e8f5e9\n    style B fill:#e8f5e9\n    style C fill:#e8f5e9</code></pre>"},{"location":"guide/quickstart/#nettoyage","title":"\ud83e\uddf9 Nettoyage","text":""},{"location":"guide/quickstart/#detruire-grafana-uniquement","title":"D\u00e9truire Grafana uniquement","text":"<pre><code># GitHub Actions\nComponent: grafana\nAction: destroy\nCONFIRM_DESTROY: DESTROY\n</code></pre>"},{"location":"guide/quickstart/#detruire-tout","title":"D\u00e9truire tout","text":"<pre><code># GitHub Actions \u2192 Destroy Serverless\nComponent: full\nAction: destroy\nCONFIRM_DESTROY: DESTROY\nDESTROY_BACKEND: yes  # Supprimer aussi S3 + DynamoDB backend\n</code></pre>"},{"location":"guide/quickstart/#temps-de-deploiement","title":"\u23f1\ufe0f Temps de D\u00e9ploiement","text":"Composant Temps Co\u00fbt apr\u00e8s d\u00e9ploiement Lambdas ~5 min ~$1/mois Grafana ~10 min +$80/mois Full ~15 min ~$81/mois"},{"location":"guide/quickstart/#prochaines-etapes","title":"\ud83c\udfaf Prochaines \u00c9tapes","text":"<ul> <li>Configuration Grafana</li> <li>Gestion des simulations</li> <li>API Reference</li> </ul>"}]}